<!DOCTYPE html>
<html lang="en">
    <head>
    <meta charset="UTF-8">
    <title>ONE PLAYER MODE</title>  
    
    <style>
        body {
            margin: 0;
            background: f2f2f2;
            font-family: 'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif;

        }
    /* to hide mouse when game start */
    body.hide-cursor {
        cursor: none;
    }
 
        #gamearea {
            width: 100vw;
            height: 100vh;
            position: relative;
            background: #ffffff;
        }

        #player {
            width: 35px;
            height: 35px;
            background: #007bff;/* ADD SPRITE LATER/*/
            position: absolute;
            border-radius: 5px;
        }

        #enemy {
            width: 32px;
            height: 32px;
            background: #ff0000;
            position: absolute;
            border-radius: 5px;
        }
        #gameover {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 48px;
            color: #ff0000;
            display: none; /* THIS IS ONLY TILL I MAKE ACTUAL END SCREEN */
        }

        #score {
            position: absolute;
            top: 10px;
            left: 10px;
            font-size: 24px;
            color: #333333;
            padding: 5px 10px;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 5px;
        }
    </style>
    </head>
    <body>
        <div id="gamearea">
            <div id="player"></div>
            <div id="enemy"></div>
            <div id="gameover">GAME OVER</div>
            <div id="score">Score: 0</div>
        </div>

        <script>
            const gameA = document.getElementById('gamearea');
            const player = document.getElementById('player');
            const enemy = document.getElementById('enemy');
            const gameOverText = document.getElementById('gameover');
            const scoreblock = document.getElementById("score")
            const accelleration = 0.89;
            const friction = 0.9;
            document.body.classList.add('hide-cursor');//starts gane with ni cursor
        

            let playerX = 200, playerY = 200;
            let enemyX = 600, enemyY = 600;
            let gamespeed = 5;
            let enemySpeed = 3;
            let pVelx = 0, pVely = 0;
            let eVelx = 0, eVely = 0;
            let enemyAcceleration = 0.64;
            let enemyFriction = 0.69;
            //pause variable for esc
            let paused = false;
            let enemyspeedboost = 1;
            let running = true;



            let score = 0;
            let keys = {};

            document.addEventListener('keydown', (e) => {
                keys[e.key] = true;
            });

            document.addEventListener('keyup', (e) => {
                keys[e.key] = false;
            });
// escape button to pause game
            document.addEventListener('keydown', (e) => {
                if (e.key === "Escape") {
                    paused = !paused;
                    if (paused) {
                        document.body.classList.remove('hide-cursor');
                    } else {
                        document.body.classList.add('hide-cursor');
                    }
                }
            });

        //functions
        function movePlayer() {
            if (keys['ArrowUp']) pVely -= accelleration;
            if (keys['ArrowDown']) pVely += accelleration;
            if (keys['ArrowLeft']) pVelx -= accelleration;
            if (keys['ArrowRight']) pVelx += accelleration;
            if (paused) return;

        //fristion
            pVelx *= friction;
            pVely *= friction;

            playerX += pVelx;
            playerY += pVely;

            const maxX = window.innerWidth - 35; //player width
            const maxY = window.innerHeight - 35; //player height

            if (playerX < 0) playerX = 0;
            if (playerY < 0) playerY = 0;
            if (playerX > maxX) playerX = maxX;
            if (playerY > maxY) playerY = maxY;
            player.style.left = playerX + "px";
            player.style.top = playerY + "px";
        }
        


        //enemy math stuff
        function moveEnemy() {
            const dx = playerX - enemyX;
            const dy = playerY - enemyY;
            const angle = Math.atan2(dy,dx);
//change with acelleration and firction stuff
                eVelx += Math.cos(angle) * enemyAcceleration * enemyspeedboost;
                eVely += Math.sin(angle) * enemyAcceleration * enemyspeedboost;
            
            eVelx *= enemyFriction;
            eVely *= enemyFriction;
            enemyX += eVelx;
            enemyY += eVely;
            enemy.style.left = enemyX + "px";
            enemy.style.top = enemyY + "px";
        }

        function collisiondetection(){
            const pRect = player.getBoundingClientRect();
            const enemyRect = enemy.getBoundingClientRect(); //do not simplify enemy and rect

            const overlap = !(pRect.right < enemyRect.left || 
                              pRect.left > enemyRect.right || 
                              pRect.bottom < enemyRect.top || 
                              pRect.top > enemyRect.bottom);
            if (overlap) {
                gameOverText.style.display = 'block';
                running = false;
            }


        }
        function updatescore(){
            score++;
            scoreblock.textContent = "Score: " + score;
            //make enemy faster update
            if (score % 10 === 0){
                enemyspeedboost *= 1.0079;
        }
    }
        function gameLoop() {
            if (!running) return;
            movePlayer();
            moveEnemy();
            collisiondetection();
            updatescore();
            requestAnimationFrame(gameLoop);
        }
        setInterval(updatescore, 1000);
        requestAnimationFrame(gameLoop);
        gameLoop();
        </script>
    </body>
</html>
